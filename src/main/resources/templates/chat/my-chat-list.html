<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>내 채팅방 | Runnity</title>
  <link rel="stylesheet" href="/chat/css/my-chat-list.css">
</head>
<body>

<header class="header">
  <h1>
    <img src="/images/unit-logo.png" alt="Runnity Logo" width="32">
    Runnity
  </h1>
  <input type="text" id="searchInput" placeholder="모임명, 지역을 검색해 주세요">
  <div class="header-btns">
    <button class="btn" onclick="location.href='/chat-room/list'">채팅 목록</button>
    <button class="btn logout">로그아웃</button>
  </div>
</header>

<div class="chat-container">
  <!-- 채팅방 목록 -->
  <aside class="chat-list">
    <div class="tab-buttons">
      <button id="groupTab" class="active">그룹</button>
      <button id="duoTab">듀오</button>
    </div>
    <ul id="chatRooms">
      <li th:each="room : ${chatRooms}" th:data-id="${room.chatRoomId}" class="chat-room-item"
          onclick="openChat(this.getAttribute('data-id'))">
        <img th:if="${room.imageUrl != null}" th:src="${room.imageUrl}" alt="chat image">
        <img th:unless="${room.imageUrl != null}" th:src="@{/images/image-upload.png}" alt="default image">
        <div class="room-info">
          <span class="room-name" th:text="${room.chatRoomName}">채팅방 이름</span>
          <span class="room-members">
            <img src="/images/runnity-person.png" style="width: 15px; height: 19px; padding-top: 5px">
            <span th:text="${#lists.size(room.members)}">0</span>
          </span>
        </div>
      </li>
    </ul>
  </aside>

  <!-- 채팅창 -->
  <section class="chat-area">
    <div id="chatHeader">
      <h2 id="chatTitle">채팅방 선택</h2>
      <div class="chat-header-btn">
        <button id="editBtn" class="edit-btn">채팅방 수정</button>
        <button id="exitBtn" class="exit-btn">나가기</button>
      </div>
    </div>

    <div id="chatMessages" class="chat-messages">
      <p class="placeholder">왼쪽에서 채팅방을 선택하세요.</p>
    </div>

    <div class="chat-input" id="chat-input">
      <input type="text" id="messageInput" placeholder="메시지를 입력하세요.">
      <button id="sendBtn">전송</button>
    </div>
  </section>
</div>

<script src="/webjars/sockjs-client/sockjs.min.js"></script>
<script src="/webjars/stomp-websocket/stomp.min.js"></script>
<script th:inline="javascript">
  /*<![CDATA[*/
  const chatRoomsData = /*[[${chatRooms}]]*/ [];
  const currentUserId = 1;
  /*]]>*/
</script>
<script src="/chat/js/my-chat-list.js"></script>
</body>
</html>
